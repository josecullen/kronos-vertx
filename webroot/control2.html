<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />    
	<link rel='stylesheet' href='/bootstrap/dist/css/bootstrap.min.css'>
    <script type="text/javascript" src="/javascripts/jquery-ui-1.10.4.custom/js/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="/javascripts/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/javascripts/ol.js"></script>
    <script type="text/javascript" src="/bootstrap/dist/js/bootstrap.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css'>
    <link rel="stylesheet" href="/stylesheets/ol.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/samples.css">
    <script>
		window.onload = function() {
		  var osmLayer = new ol.layer.Tile({
		    source: new ol.source.OSM()
		  });
		
		  var map = new ol.Map({
		    target: 'map',
		    view: window.opener.view
		  });
		
		  map.addLayer(osmLayer);
		  
		  $.get("/db/findLinea?titulo=Otra linea Nueva", function(linea, status){
				console.log(linea);
				var lineaTiempo = JSON.parse(linea);
				
				$('#lineaTiempo').empty();
				
// 				var item = 	"<a href='#' class='list-group-item active'>"; 
// 				item += 		"<p class='list-group-item-text'>"+lineaTiempo.titulo+"</p>";
//             	item += 	"</a>";
// 				$('#list').append(item);				
				
// 				var acontecimientos = lineaTiempo.acontecimientos;  
// 				acontecimientos.forEach(function(data){
// 					var item = "<a href='#' class='list-group-item'>" 
// 					item += 		"<button type='button' onclick='flyTo("+data.coordenadas+");' class='btn btn-default badge' aria-label='Left Align'>";
// 					item += 			"<span class='glyphicon glyphicon-send' aria-hidden='true'></span>";
// 					item += 		"</button>";
// 					item +=			"<p class='list-group-item-text'>"+data.titulo+"</p>";
// 					item += 	"</a>";
// 					$('#list').append(item);
// 				});	
				
			
				var item = 	"<div class='input-group col-md-12 col-sm-12 col-xs-12'>";
				item +=			"<a href='#' class='list-group-item active'>";
				item += 			"<p class='list-group-item-text'>"+lineaTiempo.titulo+"</p>";
				item +=		 	"</a>";
				item +=		"</div>";				 
				 
				$('#lineaTiempo').append(item);				
				
				var acontecimientos = lineaTiempo.acontecimientos;  
				acontecimientos.forEach(function(data){
					var item = "<div class='input-group'>";
					item +=			"<a href='#' class='list-group-item' onclick='console.log(\""+data.titulo+"\");'>";
					item +=				"<h4 class='list-group-item-text'>"+data.titulo.substring(0,30)+"</h4>";
					item +=				"<h5 class='list-group-item-text'>"+data.dia+"/"+data.mes+"/"+data.año+"</h5>";
					item +=			"</a>";
					item +=			"<span class='input-group-addon glyphicon glyphicon-modal-window' onclick='console.log(\'hola\')' style='cursor:pointer'></span>";
					item +=			"<span class='input-group-addon glyphicon glyphicon-send' onclick='flyTo("+data.coordenadas+");' style='cursor:pointer'></span>";		
					item +=		"</div>";		
					$('#lineaTiempo').append(item);
				});
						
				
			});		
		}
		
		function flyTo(x,y){
			console.log("flyTo" +x+" "+y);
	        var location = ol.proj.transform([parseFloat(x), parseFloat(y)], 'EPSG:4326', 'EPSG:3857');
	        window.opener.doBounce(location);
		}
    </script>

  </head>

  <body>
    <div class="jumbotron">
      <div class="container">
        <h1>Control Remoto</h1>
        <div id="lineaTiempo" class="col-md-4 col-sm-12 col-xs-12"></div>
        
        <div class="col-md-4 col-sm-12 col-xs-12">      
	      <div class="input-group col-md-12 col-sm-12 col-xs-12">
	        <a href="#" class="list-group-item active ">
	          <p class="list-group-item-text">Otras Líneas</p>
	        </a>
	      </div>	      
	      <div class="input-group">
	        <a href="#" class="list-group-item">
	          <h4 class="list-group-item-text">Línea de Tiempo 1</h4>
	          <h5 class="list-group-item-text">15 de Enero 1815</h5>
	        </a>
	        <span class="input-group-addon glyphicon glyphicon-modal-window" onclick="console.log('hola')" style="cursor:pointer"></span>
	      </div>
   		</div>
        
        
		<div class="col-md-4 col-sm-12 col-xs-12">      
	      <div class="input-group col-md-12 col-sm-12 col-xs-12">
	        <a href="#" class="list-group-item active ">
	          <p class="list-group-item-text">Acontecimientos</p>
	        </a>
	      </div>	      
	      <div class="input-group">
	        <a href="#" class="list-group-item">
	          <h4 class="list-group-item-text">Acontecimiento 1</h4>
	          <h5 class="list-group-item-text">15 de Enero 1815</h5>
	        </a>
	        <span class="input-group-addon glyphicon glyphicon-modal-window" onclick="console.log('hola')" style="cursor:pointer"></span>
	        <span class="input-group-addon glyphicon glyphicon-send" onclick="console.log('hola')" style="cursor:pointer"></span>
	      </div>	
		</div>
        
        
      </div>
      
    </div>
    <div class="container">
      <div id="map" class="map col-md-4"></div>
    </div>
  </body>
</html>
